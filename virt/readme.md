# Займёмся виртом?

Здравствуйте, меня зовут дмитрий Карловский и я.. каждый день делаю это.. виртуализирование интерфейсы. Я делал иерархические списки задач на 40К штук, редактор документов на 200 страниц, и даже запилил фреймворк, где виртуализация происходит автоматически. Короче, съел я на той теме собаку, кошку, хорька, енота и даже морскую свинку. Так что далее я расскажу как эффективно предоставлять пользователю огромные объёмы данных, почему вообще возникает такая необходимость, какие технологии нам с этим могут помочь, и почему Реакт не способен избавить нас от головной боли.

[Дмитрий Карловский @ HolyJS'20 Moscow](https://holyjs-moscow.ru/)

## Типичный цикл разработки

- Написали код
- Проверили в типличных условиях
- Пришли пользователи и всё заспамили

## Наивный рендеринг

- Медленная загрузка
- Жрём много памяти
- Плохая отзывчивость

## Оптимизации

- Упрощение вёрстки - асимптотика не меняется
- Виртуализация - ручные приседания
- Вирт-фреймворк - то, что надо

## Ручной вирт

- Пагинация
- Экспандеры
- Бесконечный скролл
- Вирт скролл

## Автоматический вирт

- Тайм слайсинг
- Прогрессивный рендеринг
- Ленивый рендеринг
- Виртуальный рендеринг

...

Соответственно, расскажу про реализацию виртуального рендеринга:
- почему react-like компоненты для этого не годятся
- про архитектуру $mol_view с оценками размеров компонент и ленивым их инстанцированием
- про scroll-anchoring - ахилесову пяту виртуализации, как он работает и как его применять
Наконец, покажу демки, где можно будет увидеть:
- высокую скорость открытия
- высокую отзывчивость
- минимальное потребление памяти
Ну и про недостатки, конечно:
- скачки скроллбара в случае неточной оценки размеров
- слабая кроссбраузерность (в сафари фоллбек до ленивого рендеринга)
- скачки контента при горизонтальном скролле (пока не победил, думаю как раз попросить помощь зала)

В действии можно глянуть тут:
https://nin-jin.github.io/habrcomment/#article=423889
https://bench.hyoo.ru/#bench=https%3A%2F%2Fbench.hyoo.ru%2Flist%2F/sample=mol~react/sort=fill/count=10000
