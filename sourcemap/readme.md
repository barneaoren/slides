# Что не так с сорсмапами и как с ними не связываться

# Зачем всё это нужно?

- Без DSL один бойлерплейт
- JS ужасен
- И в TS фатальные недостатки
- Хочу и всё

# Известные примеры

- TypeScript, FlowJS и прочие ЯП
- SCSS, Less, Stylus PostCSS и прочие препроцессоры стилей
- SVGO, CSSO и прочие оптимизаторы
- JSX, Pug, Handlebars и прочие шаблонизаторы
- MD, TeX и прочие языки разметки
- ESLint и прочие линтеры

# Какие есть проблемы с генерацией?

- результат сильно не похож на исходник
- в результате чёрт ногу сломит
- имена не соответствуют

# Сорсмапы всех спасут! Или нет..

- Отображение исходников
- Дебаггер "ходит" по исходникам
- Отображение стектрейса
- Значения переменных при наведении

# Как работают сорсмапы

# Формат сорсмапов

# Как подключаются

# Когда и как загружаются браузером

# Пробуем генерить руками

- звиздец сложно
- носиться с ними во всех трансформациях
- носиться с ними в сообщениеях об ошибках

# Чёт сложно, нужна абстракция

# храним координаты в ast

# новые узлы создаём на базе существующих

# пайплайн

- загрузили аст
- трансфрмировали и почекали
- сериализовали в скрипты/стили и сорсмапы

# Хороший тон

- Укзывать на исходник, а не шаблон
- Генерить инструкции, а не выражения
- Прикладывать исходник

# как дебажить трансфрмации

- формат наглядного представления аст

# песочница трансформаций

# пилим свой dsl сразу на ast

- самый простой путь
- синтаксис специфический

# jack.tree - макро язык

# хотим совсем свой синтаксис

- парсим в аст

# не только скрипты

- стили
- хтмл
- что угодно

# меняем таргеты налету (js/wasm?)

# даже wasm с сорсмапингом?!

# LS для IDE

- Привязка структур к узлам аст

# Подсветка синтаксиса

- для tree уже есть но можно сделать кастомизируемую
- для своего языка через парсинг в tree

